{% extends 'netpitch/base.html' %}
{% load static %}
{% load form_tags %} 

{% block content %}
<div class="container">
    <div class="profile-header text-center">
        <img class="profile-image" src="{% if profile.profile_image %}{{ profile.profile_image.url }}{% else %}{% static 'default.jpg' %}{% endif %}" alt="{{ profile.user.username }}">
    </div>
    <h1>{{ profile.user.username }}</h1>
    <p>{{ profile.bio }}</p>
    
<!-- Conditional section based on user type -->
    {% if profile.user_type == 'Writer' %}

<!-- Update Profile & Submit Pitch Deck Button -->
<div class="container">
    <div class="row">
        <div class="col-md">
            <a href="{% url 'update_profile' %}" class="btn btn-purple btn-block">Update Profile</a>
        </div>
        <div class="col-md">
            <a href="{% url 'submit_pitch_deck' %}" class="btn btn-purple btn-block">Submit New Pitch Deck</a>
        </div>
    </div>
</div>

<!-- Pitch Deck -->
<h2 class="mt-5">Pitch Decks</h2>
<div class="pitch-deck-grid">
    {% for pitch in pitch_decks %}
        <a href="{% url 'pitch_deck_detail' pitch.id %}" class="pitch-deck-link">
            <div class="pitch-deck-card" style="background-image: url('{% if pitch.image %}{{ pitch.image.url }}{% else %}{% static 'images/default_pitch_image.jpg' %}{% endif %}');">
                <div class="pitch-deck-info">
                    <strong>{{ pitch.title }}</strong> - {{ pitch.pitch_type }}
                    <p><strong>Genre:</strong> {{ pitch.genre.name }}</p>
                    <p><strong>Theme:</strong> {{ pitch.theme }}</p>
                </div>
            </div>
        </a>
    {% empty %}
        <li class="list-group-item">No pitch decks yet.</li>
    {% endfor %}
</ul>

<!-- Collaboration Requests-->
    {% elif profile.user_type == 'Producer' %}
        <h2 class="mt-5">Your Collaboration Requests</h2>
        <ul class="list-group">
            {% for request in collaboration_requests %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong>{{ request.pitch.title }}</strong> 
                        <p class="mb-1"><strong>Status:</strong> {{ request.status }}</p>
                    </div>
                    <a href="{% url 'pitch_deck_detail' request.pitch.id %}" class="btn btn-outline-info btn-sm">View Pitch</a>
                </li>
            {% empty %}
                <li class="list-group-item">No collaboration requests yet.</li>
            {% endfor %}
        </ul>
    {% endif %}
</div>
{% endblock %}